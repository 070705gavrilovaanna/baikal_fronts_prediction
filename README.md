# Прогнозирование фронтов на озере Байкал

Проект по прогнозированию атмосферных фронтов на озере Байкал на основе исторических данных температуры за 2014-2025 годы. Было предсказано появление фронтов на следующий день. Данные собраны самостоятельно через NASA POWER API.

**Ссылка на проект:** [baikal_fronts_prediction.ipynb](https://colab.research.google.com/drive/1R5NMMWnes2M0-zLzCZjTe8vt3qtcyJPy)


## Данные

Исходный датасет не включен в репозиторий из-за ограничений лицензии NASA. 
Полное описание структуры данных: [dataset_info.md](dataset_info.md)

---

## Как это сделано

**Технологии:** Python, Pandas, Scikit-learn, XGBoost, Matplotlib, Seaborn, Requests

**Этапы работы:**

1. **Сбор данных:** Загрузка ежедневных температуры за 2014-2025 годы. Использованы координаты озера Байкал (latitude: 53.5, longitude: 108.0)

2. **Исследовательский анализ (EDA):**
   - Визуализировала временной ряд температуры
   - Проанализировала распределение температур
   - Изучила сезонные закономерности

3. **Создание признаков (feature engineering):**
   Создала 14 осмысленных метеорологических признаков:
   - **Изменение температуры:** за 24 и 48 часов
   - **Амплитуда температуры:** разброс за 3 дня
   - **Определение фронтов:** холодные, теплые и стационарные фронты по метеорологическим критериям
   - **Временные признаки:** день года, день недели, месяц
   - **Циклические признаки:** синус и косинус дня года для учета сезонности
   - **Исторические температуры:** значения за 1, 2, 3 дня назад
   - **Статистики:** среднее и стандартное отклонение за 3 дня
   - **Сезонные признаки:** холодный сезон (ноябрь-март)
   - **Комбинированные признаки:** взаимодействие изменений температуры с другими параметрами

4. **Целевая переменная:** Бинарная классификация: будет ли завтра фронт (1) или нет (0).

5. **Моделирование:**
   - Сравнила два алгоритма: RandomForest и XGBoost
   - Использовала временное разделение данных (80/20)
   - Лучшая модель: **RandomForest** с точностью 74%
   - Метрики:
     - **Precision для фронтов:** 0.61
     - **Recall для фронтов:** 0.50
     - **F1-score:** 0.55

6. **Анализ важности признаков:**
   - Самый важный признак: **temp_diff24** (изменение температуры за 24 часа) - 41%
   - Второй по важности: **temp_1days_ago** (температура вчера) - 14%
   - Третий: **temp_2days_ago** (температура позавчера) - 7%

---

## Оптимизация

1. **Балансировка классов:** Использовала class_weight='balanced' в RandomForest и scale_pos_weight в XGBoost для борьбы с дисбалансом классов.
2. **Временное разделение:** Разделила данные временно (80/20) вместо случайного, что более реалистично для временных рядов.
3. **Комбинированные признаки:** Создала признаки-взаимодействия (change_std, change_amplitude, change_season) для усиления информативности.
4. **Стандартизация:** Применила StandardScaler для числовых признаков.
5. **Циклическое кодирование:** Преобразовала день года в синус/косинус для учета годового цикла.

---

## Что я узнала

1. Для метеорологических данных критически важно временное разделение, а не случайное.
2. Понимание разницы между холодными и теплыми фронтами помогло создать осмысленные критерии для их определения.
3. Фронты это редкое событие, потребовалась специальная настройка моделей.
4. Самые простые признаки (изменение температуры за сутки) оказались самыми важными.
5. Важность признаков дала понимание, какие физические процессы действительно влияют на формирование фронтов.

**Ключевой вывод:** Даже с относительно простыми метеорологическими данными (только температура) можно строить полезные прогностические модели, если правильно определить целевую переменную и создать осмысленные признаки на основе физики атмосферных процессов.
